refactored into oop, refactored tests
